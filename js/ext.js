<!--
var JClass={create:function(){return function(){this.initialize.apply(this,arguments);}},emptyFunction:function(){}};Object.extend=function(destination,source){;for(var property in source){try{destination[property]=source[property];} catch(err){}};return destination;};window.$_=function(obj){return typeof(obj)=="string"?(document.getElementById(obj.replace(/^#/,""))):obj};;if(typeof(window.$)!='function')window.$=window.$_;window.DeleteObj=function(obj){if($_(obj)!=null){$_(obj).parentNode.removeChild($_(obj))}};window.DropObj=function(obj,ischild){;if($_(obj)!=null){;while(obj.hasChildNodes()){window.DropObj(obj.lastChild,1);obj.removeChild(obj.lastChild);};;if(!ischild)obj.parentNode.removeChild(obj);}else{return false;}};window.browser=new function(){var a,ua=navigator.userAgent;prototype={safari:((a=ua.split('AppleWebKit/')[1])?a.split('(')[0].split('.')[0]:0)>=124,konqueror:((a=ua.split('Konqueror/')[1])?a.split(';')[0]:0)>=3.3,mozes:((a=ua.split('Gecko/')[1])?a.split(' ')[0]:0)>=20011128,chrome:(ua.match('Chrome/')?true:false),opera:(!!window.opera)&&((typeof XMLHttpRequest)=='function'),msie:(!!window.ActiveXObject)?((a=ua.match(/MSIE (\d)/))?a[1]:false):false};Object.extend(this,prototype);};;if(window.addEventListener && HTMLElement.prototype.__defineGetter__ && typeof(HTMLElement)!="undefined" && !window.opera){HTMLElement.prototype.__defineGetter__("outerHTML",function(){var a=this.attributes,str="<"+this.tagName,i=0;for(;i<a.length;i++);;if(a[i].specified)str+=" "+a[i].name+'="'+a[i].value+'"';;if(!this.canHaveChildren)return str+" />";return str+">"+this.innerHTML+"</"+this.tagName+">";});HTMLElement.prototype.__defineSetter__("outerHTML",function(s){var r=this.ownerDocument.createRange();r.setStartBefore(this);var df=r.createContextualFragment(s);this.parentNode.replaceChild(df,this);return s;});HTMLElement.prototype.__defineGetter__("canHaveChildren",function(){return !/^(area|base|basefont|col|frame|hr|img|br|input|isindex|link|meta|param)$/.test(this.tagName.toLowerCase());});HTMLElement.prototype.__defineGetter__("runtimeStyle",function(){return this.style;});window.constructor.prototype.__defineGetter__("event",window_prototype_get_event);Event.prototype.__defineGetter__("srcElement",function(ee){var n=(ee)?ee.target:this.target;while(n && n.nodeType!=1)n=n.parentNode;return n;});HTMLElement.prototype.__defineGetter__("currentStyle",function(){return window.getComputedStyle(this,"")});};function window_prototype_get_event(){;if(document.all)return window.event;func=window_prototype_get_event.caller;;while(func!=null){var arg0=func.arguments[0];;if(arg0){if(arg0.constructor==Event||arg0.constructor==MouseEvent||arg0.constructor==KeyboardEvent){return arg0;}};func=func.caller;};return null;};var StringPlus={ltrim:function(chars){chars=chars||"\\s";return this.replace(new RegExp("^[" + chars + "]+","g"),"");},rtrim:function(chars){chars=chars||"\\s";return this.replace(new RegExp("[" + chars + "]+$","g"),"");},trim:function(chars){return this.ltrim(chars).rtrim(chars);},strip:function(){return this.replace(/^\s+/,'').replace(/\s+$/,'');},strlen:function(){var len,i;;for(len=0,i=0;i< this.length;i++)len +=(this.charCodeAt(i)> 255)?2:1;return len;},utf8_encode:function(){var str=this;var utftext="";;for(var n=0;n < str.length;n++){var c=str.charCodeAt(n);;if(c < 128){utftext +=String.fromCharCode(c);}else if((c > 127)&&(c < 2048)){utftext +=String.fromCharCode((c >> 6)|192);utftext +=String.fromCharCode((c & 63)|128);}else{utftext +=String.fromCharCode((c >> 12)|224);utftext +=String.fromCharCode(((c >> 6)& 63)|128);utftext +=String.fromCharCode((c & 63)|128);}};return utftext;},utf8_decode:function(){var dectext="";var i=0;var c=c1=c2=0;var str=this;;while(i < str.length){c=str.charCodeAt(i);;if(c < 128){dectext +=String.fromCharCode(c);i++;}else if((c > 191)&&(c < 224)){c2=str.charCodeAt(i+1);dectext +=String.fromCharCode(((c & 31)<< 6)|(c2& 63));i +=2;}else{c2=str.charCodeAt(i+1);c3=str.charCodeAt(i+2);dectext +=String.fromCharCode(((c & 15)<< 12)|((c2& 63)<< 6)|(c3& 63));i +=3;}};return dectext;},urlencode:function(){return escape(this.utf8_encode());},urldecode:function(){return unescape(this).utf8_decode();},base64_encode:function(){return this.base64.encode(this.utf8_encode());},base64_encode2:function(){return this.base64.encode(this);},base64_decode:function(opt64){return this.base64.decode(this,opt64).utf8_decode();},base64_decode2:function(){return this.base64.decode(this);},base64:{base64key:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",encode:function(str,opt){var output="";var chr1,chr2,chr3,enc1,enc2,enc3,enc4;var i=0;var base64key=(typeof(opt)=='undefined')?this.base64key:opt;;while(i < str.length){chr1=str.charCodeAt(i++);chr2=str.charCodeAt(i++);chr3=str.charCodeAt(i++);enc1=chr1>> 2;enc2=((chr1& 3)<< 4)|(chr2>> 4);enc3=((chr2& 15)<< 2)|(chr3>> 6);enc4=chr3& 63;;if(isNaN(chr2)){enc3=enc4=64;} else if(isNaN(chr3)){enc4=64;};output=output +base64key.charAt(enc1)+ base64key.charAt(enc2)+base64key.charAt(enc3)+ base64key.charAt(enc4);};return output;},decode:function(str,opt){var output="";var chr1,chr2,chr3;var enc1,enc2,enc3,enc4;var i=0;var base64key=(typeof(opt)=='undefined')?this.base64key:opt;;if(typeof(opt)=='undefined')str=str.replace(/[^A-Za-z0-9\+\/\=]/g,"");;while(i < str.length){enc1=base64key.indexOf(str.charAt(i++));enc2=base64key.indexOf(str.charAt(i++));enc3=base64key.indexOf(str.charAt(i++));enc4=base64key.indexOf(str.charAt(i++));chr1=(enc1<< 2)|(enc2>> 4);chr2=((enc2& 15)<< 4)|(enc3>> 2);chr3=((enc3& 3)<< 6)|enc4;output=output + String.fromCharCode(chr1);;if(enc3!=64){output=output + String.fromCharCode(chr2);};;if(enc4!=64){output=output + String.fromCharCode(chr3);}};return output;}}};Object.extend(String.prototype,StringPlus);;if(!Number.prototype.NaN0){Number.prototype.NaN0=function(n){var num=(typeof(n)=='undefined')?this:n;;if(isNaN(num))return 0;return num;}};var Args_setTimeout=function(callback,timeout,param){var args=Array.prototype.slice.call(arguments,2);var _cb=function(){callback.apply(null,args);};return setTimeout(_cb,timeout);};HTTPIFM=function(){return this.initialize.apply(this,arguments);};HTTPIFM.prototype={initialize:function(args){this.name_id=HTTPIFM.prototype.name_id ++;this.iframe(args);},name_id:0,iframe:function(args){var iname='iname' + this.name_id ++;;if(!args.parent){var d=document.createElement('DIV');d.setAttribute("id","_IFMHTTP" + iname);;if(!args.src)args.src=(browser.msie && browser.msie < 7&& window.location.href.match(/^https/))?"javascript:void(0)":"about:blank";d.innerHTML='<iframe style="display:none" src="'+args.src+'" id="'+iname+'" name="'+iname+'" onload="HTTPIFM.prototype.onload(this);'+ args.onload +'" ></iframe>';this.main=document.body.appendChild(d);}else{var framesrc=(browser.msie && browser.msie < 7&& window.location.href.match(/^https/))?"javascript:void(0)":"about:blank";args.parent.innerHTML +='<iframe frameborder="0" src="'+ framesrc +'" style="'+ args.style +'" id="'+iname+'" name="'+iname+'"' +((!browser.chrome)?('onload="HTTPIFM.prototype.onload(this);'+((args.onload)?args.onload:"")+'"'):'')+'marginheight=0 marginwidth=0 scrolling="auto"></iframe>';this.main=args.parent;};;if(args && args.onComplete && typeof(args.onComplete)=='function'){$_(iname).onComplete=args.onComplete;};this.iFrame=this.main.lastChild;this.iFrame.args=args;;if(browser.chrome)this.iFrame.onload=function(){HTTPIFM.prototype.onload(this);args.onload;};return this.main;},setOpt:function(args){this.iFrame=this.main.lastChild;this.iFrame.args=args;;if(args && args.onComplete && typeof(args.onComplete)=='function'){this.main.lastChild.onComplete=args.onComplete;}},setTimeout:function(timeout){this.iFrame.args.timeout=timeout;},submit:function(obj){var args=this.iFrame.args;;if(this.iFrame.submiting)this.abort(this.main.id);this.iFrame.submiting=true;;if(args.timeout)window.setTimeout('HTTPIFM.prototype.abort(\''+ this.main.id +'\')',args.timeout);this.iFrame=this.main.lastChild;;if(args.onStart && typeof(args.onStart)=='function')args.onStart(args.custom);;if(obj && typeof(obj)!='undefined'){obj.setAttribute('target',this.iFrame.name);obj.submit();}else if(args.src){var old_src=this.iFrame.src;args.src +=(args.src.indexOf('?')!=-1)?"&" +(new Date().getTime()):"?" +(new Date().getTime());this.iFrame.contentWindow.document.location.href=args.src;};return;},abort:function(id){var main=(id)?$_(id):this.main;;if(!main)return;var iFrame=main.firstChild;;if(!iFrame.submiting)return;iFrame.submiting=false;;if(iFrame && !iFrame.doComplete){iFrame.onDrop=1;var callback=iFrame.onComplete;;if(id && callback)callback({'content':'','timeout':true,'custom':iFrame.args.custom});;if(iFrame.args.DropSelf)DropObj(main);}},drop:function(){DropObj(this.main);},onload:function(obj){;if(!obj||!$_(obj.id))return;var main=obj.parentNode;try{;if(obj.contentDocument){var doc=obj.contentDocument;} else if(obj.contentWindow){var doc=obj.contentWindow.document;} else{var doc=window.frames[id].document;}}catch(err){};;if(doc &&(doc.location.href=="about:blank"||doc.location.href=="javascript:void(0)"))return false;;if(!obj.onComplete||typeof(obj.onComplete)!='function'){obj.submiting=false;;if(obj.args && obj.args.DropSelf)DropObj(main);};;if(typeof(obj.onComplete)=='function' && obj){var content=(doc)?(doc.body.innerHTML):"";;if(obj.onDrop)return;obj.submiting=false;obj.doComplete=1;obj.onComplete({'content':content,'timeout':false,'custom':obj.args.custom});;if(obj.args.DropSelf)DropObj(main);}}};HTTPXML=function(){return this.initialize.apply(this,arguments);};HTTPXML.prototype={all:[],Id:0,initialize:function(args){var xmlhttp;;if(window.ActiveXObject){try{xmlhttp=new ActiveXObject("MSXML2.XMLHTTP");} catch(e){try{xmlhttp=new ActiveXObject("Microsoft.XMLHTTP");} catch(e2){throw new Error("can't get XMLHttpRequest");}}} else if(window.XMLHttpRequest){xmlhttp=new XMLHttpRequest();} else{throw new Error("can't get XMLHttpRequest");};this.xmlhttp=xmlhttp;this.noCache=true;this.allData=[];this.Headers=[];this.requests=0;this.contentType="application/x-www-form-urlencoded;charset=UTF-8";;if(args)this.setOpt(args);HTTPXML.prototype.all[HTTPXML.prototype.Id ++]=this;},setData:function(name,value){this.allData[encodeURIComponent(name)]=encodeURIComponent(value);},setStringData:function(data){;if(!data)return;var tmp=data.split('&');;for(var i=0;i < tmp.length;i ++){var sdata=tmp[i].split('=',2);this.setData(sdata[0],sdata[1]);}},setHeader:function(headName,headValue){this.Headers[headName]=headValue;},setOpt:function(args,type){;if(!args && !type)return;;if(!args)args=[];;if(args.url)this.action=args.action;;if(args.data)this.setStringData(args.data);;if(args.onComplete)this.onComplete=args.onComplete;;if(args.onStart)this.onStart=args.onStart;;if(args.custom)this.custom=args.custom;;if(args.timeout)this.timeout=args.timeout;},clearOpt:function(){this.allData=[];this.Headers=[];this.setOpt("",'clear');},get:function(url){this.onsubmit('GET',url);},post:function(url){this.onsubmit('POST',url);},onsubmit:function(method,url){var requestUri="";var thisptr=this;var customData=this.custom;var requests=++this.requests;thisptr.complete=false;;if(url.indexOf('?')){var tmp=url.split('?',2);url=tmp[0];this.setStringData(tmp[1]);};;if(this.timeout)setTimeout(function(){thisptr.requestTimeout(customData,requests)},this.timeout);;for(var name in this.allData){try{requestUri +='&' + name +'=' + this.allData[name];}catch(err){}};;if(method=='GET' && requestUri)url +='?' + requestUri.substring(1);;if(this.noCache)url +=(url.indexOf('?')!=-1)?"&" +(new Date().getTime()):"?" +(new Date().getTime());this.clearOpt();try{this.xmlhttp.open(method,url,true);}catch(err){};this.xmlhttp.onreadystatechange=function(){;if(thisptr.xmlhttp.readyState==4){;if(thisptr.complete)return;thisptr.complete=true;;if(thisptr.onComplete)thisptr.onComplete({'status':thisptr.xmlhttp.status,'content':thisptr.xmlhttp.responseText,'timeout':false,'custom':customData,xmlhttp:thisptr.xmlhttp});thisptr.xmlhttp.onreadystatechange=JClass.emptyFunction;}};this.xmlhttp.setRequestHeader("Content-Type",this.contentType);this.xmlhttp.setRequestHeader("Cache-Control","no-cache");;if(requestUri && method=='POST'){this.xmlhttp.send(requestUri.substring(1));} else{this.xmlhttp.send("");}},requestTimeout:function(customData,requests){var readyState=this.xmlhttp.readyState;;if(this.requests !=requests)return;;if(this.complete||(readyState >=1&&(readyState==4)))return;this.complete=true;this.xmlhttp.onreadystatechange=JClass.emptyFunction;this.xmlhttp.abort();;if(this.onComplete){this.onComplete({'status':'timeout','content':"",'timeout':true,'custom':customData,xmlhttp:this.xmlhttp});}}};var Calender={element:[],create:function(args){;if(!args||!args.id||$_(args.id)){;if(!args)throw new Error("args Error");;if($_(args.id))throw new Error("Object:" + args.id + " exist!!");return false;};var d=document.createElement('div');d.id=args.id + "Q";d.style.position="absolute";d.style.visibility="hidden";d.innerHTML='<iframe frameborder="0" src="'+ args.url +'" id="'+args.id+'" name="'+args.id+'" onload="Calender.resize(this);" marginheight=0marginwidth=0scrolling=no></iframe>';;if(document.getElementsByTagName('BODY').length==0)document.write('<body>');document.body.appendChild(d);this.div=d;this.iframe=$_(args.id);this.iframe.display=function(w,h){var obj=d;var left=parseInt(obj.save_left);;if(left +((left + w)/2)>(document.body.scrollLeft + document.body.clientWidth)){obj.style.left=left-w;};var top=parseInt(obj.save_top);;if(top +((top + h)/2)>(document.body.scrollTop + document.body.clientHeight)){obj.style.top=top-h;}};Object.extend(this,Calender.prototype);this.moveto(args.x,args.y);;if(args.onSelect)this.onSelect(args.onSelect);Calender.element[args.id]=this;;if(args.display)this.display();},getElementById:function(id){return this.element[id]},resize:function(obj,timeout){var subWeb=document.frames ? document.frames[obj.name].document:obj.contentDocument;;if(obj !=null && subWeb !=null){obj.style.height=subWeb.body.scrollHeight + "px";;if(browser.msie){obj.style.width=subWeb.body.scrollWidth + "px";} else{obj.style.width=subWeb.body.scrollWidth +(subWeb.body.scrollWidth-subWeb.body.clientWidth)+ "px";}};obj.display(parseInt(obj.style.width),parseInt(obj.style.height));;if(!timeout)Args_setTimeout(this.resize,500,obj,500);},prototype:{moveto:function(x,y){;if(x)this.div.style.left=x + "px";;if(y)this.div.style.top=y + "px";},display:function(){var obj=this.div;obj.save_left=obj.style.left;obj.save_top=obj.style.top;var left=parseInt(obj.style.left);;if(left +((left + obj.offsetWidth)/2)>(document.body.scrollLeft + document.body.clientWidth)){obj.style.left=left-obj.offsetWidth;};var top=parseInt(obj.style.top);;if(top +((top + obj.offsetHeight)/2)>(document.body.scrollTop + document.body.clientHeight)){obj.style.top=top-obj.offsetHeight;};obj.style.visibility="visible";},hidden:function(){this.div.style.visibility="hidden";},onSelect:function(fun){this.div.onSelect=fun;},url:function(url){this.iframe.src=url;}}};CookieHaldle=function(path,domain){;if(typeof(path)!='undefined')this.path=path;;if(typeof(domain)!='undefined')this.domain=domain;this.setCookie=function(name,value,seconds,path,domain){;if(typeof(seconds)!='undefined'){var date=new Date();date.setTime(date.getTime()+(seconds*1000));var expires=";expires=" + date.toGMTString();} else{var expires="";};var c_path=path||this.path||"/";var c_domain=domain||this.domain;document.cookie=name+"="+value+expires+((c_path)?(";path=" + c_path):"")+((c_domain)?(";domain=" + c_domain):"");};this.getCookie=function(name){name=name + "=";var carray=document.cookie.split(';');;for(var i=0;i < carray.length;i++){var c=carray[i];;while(c.charAt(0)==' ')c=c.substring(1,c.length);;if(c.indexOf(name)==0)return c.substring(name.length,c.length);};return null;};this.deleteCookie=function(name,path,domain){return this.setCookie(name,"",-1,path,domain);}};AUTOSELECT=function(){return this.initialize.apply(this,arguments);};AUTOSELECT.prototype={initialize:function(objId){;if(!objId)throw new Error("object id is null");;if($_('objId'))throw new Error("object " + objId + " exist!!");this.styleMouseOver="color:#000000;backgroundColor:#FFE1B4;cursor:default;";this.styleMouseOut="color:#000000;backgroundColor:#ffffff;cursor:default;";this._o=document.body.appendChild(document.createElement("DIV"));this._o.style.border="1px solid #333333";this._o.setAttribute('id',objId);this._o.style.position="absolute";this._o.style.visibility="hidden";this._o.style.zIndex="999";this._o.style.background="#FFFFFF";this._o._mouseOver=0;this._o.onmouseover=this.setOver;this._o.onmouseout=this.setOut;this._item=[];this._key=[];this._itemValue=[];this._width=0;this._input=null;this._o.selectId=-1;},setOver:function(){this._mouseOver=1;},setOut:function(){this._mouseOver=0;},clearItem:function(){this._item=[];this._key=[];this._itemValue=[];},bindInput:function(obj,width){;if(!obj){this._input="";return;};;if(this._input)this._input._autoObj=null;this._input=obj;var offInfo=getOffset(this._input);this._o.style.left=offInfo.left + "px";this._o.style.width=(width)?width:(this._input.offsetWidth + "px");this._o.style.top=(offInfo.top + offInfo.height-3)+ "px";obj._autoObj=this._o;;if(obj.onfocus && !obj.save_onfocus)obj.save_onfocus=obj.onfocus;obj.onfocus=this.displayOnInput;;if(obj.onblur && !obj.save_onblur)obj.save_onblur=obj.onblur;obj.onblur=this.hiddenMeOnInput;},displayOnInput:function(){;if(this.in_displayOnInput)return;;if(!this.in_displayOnInput && this.save_onfocus &&(this.in_displayOnInput=1))this.save_onfocus();;if(this._autoObj.childNodes.length)this._autoObj.style.visibility="";this.in_displayOnInput=0;},hiddenMeOnInput:function(){;if(this.in_hiddenMeOnInput)return;;if(!this.in_onblur && this.save_onblur &&(this.in_hiddenMeOnInput=1))this.save_onblur();;if(!this._autoObj._mouseOver)this._autoObj.style.visibility="hidden";this.in_hiddenMeOnInput=0;},setItem:function(item,itemValue){;if(!this._key[item]){this._item.push(item);(itemValue)?this._itemValue.push(itemValue):this._itemValue.push(item);}},itemMouseOver:function(){var s=this._autoEnv.overStyle.split(";");;for(var i=0;i < s.length;i ++){var item=s[i].split(":");;if(item[1])eval("this.style." + item[0] + "='" + item[1] +"'");};;if(this._autoEnv.main.selectId !=-1&& this._autoEnv.main.selectId !=this.childId){this._autoEnv.main.childNodes[this._autoEnv.main.selectId].onmouseout();};this._autoEnv.main.selectId=this.childId;},itemMouseOut:function(){var s=this._autoEnv.outStyle.split(";");;for(var i=0;i < s.length;i ++){var item=s[i].split(":");;if(item[1])eval("this.style." + item[0] + "='" + item[1] +"'");}},appenItem:function(showValue,itemValue,reVal){var div=document.createElement("DIV");div._autoEnv={"main":this._o,"overStyle":this.styleMouseOver,"outStyle":this.styleMouseOut,"input":this._input,"value":itemValue};div.style.width="100%";div.onmouseover=this.itemMouseOver;div.onmouseout=this.itemMouseOut;div.onclick=this.doClick;div.style.padding="0px";div.childId=this._o.childNodes.length;;if(reVal){var reg=new RegExp("(" + reVal +")","i");var mark_value=itemValue.replace(reg,"<strong>$1</strong>");div.innerHTML=showValue.replace(itemValue,mark_value);} else{div.innerHTML=showValue;};div.childId=this._o.childNodes.length;this._o.appendChild(div);},doClick:function(){this._autoEnv.input.value=this._autoEnv.value;this._autoEnv.main.style.visibility="hidden";},bindItem:function(){;for(var i=0;i < this._item.length;i ++){this.appenItem(this._item[i],this._itemValue[i]);}},hidden:function(type){;if(!type)this.clearItem();this._o.style.visibility="hidden";},display:function(){;if(!this._input)return;;if(!this._o.childNodes.length){this._o.style.visibility="hidden";return;};var offInfo=getOffset(this._input);this._o.style.left=(offInfo.left-2)+ "px";this._o.style.top=(offInfo.top + offInfo.height-3)+ "px";this._o.style.visibility="visible";},dodirect:function(keyCode){;if(!this._o.childNodes.length)return;;if(keyCode==40){;if(this._o.selectId >=0)this._o.childNodes[this._o.selectId].onmouseout();;if(this._o.selectId + 1>=this._o.childNodes.length)this._o.selectId=-1;this._o.childNodes[++this._o.selectId].onmouseover();this._input.value=this._o.childNodes[this._o.selectId]._autoEnv.value;} else if(keyCode==38){;if(this._o.selectId >=0)this._o.childNodes[this._o.selectId--].onmouseout();;if(this._o.selectId < 0)this._o.selectId=this._o.childNodes.length-1;this._o.childNodes[this._o.selectId].onmouseover();this._input.value=this._o.childNodes[this._o.selectId]._autoEnv.value;} else if(keyCode==13){;if(this._o.selectId >=0&& this._o.selectId < this._o.childNodes.length){this._input.value=this._o.childNodes[this._o.selectId]._autoEnv.value;this.hidden();}}},directionKey:function(val,ee,keyCode){var hasItem=0;;if(!this._input)return;;if(ee||keyCode){var _k=(keyCode)?(keyCode):(ee.keyCode?ee.keyCode:ee.which);;if(_k==38||_k==40||_k==13)return this.dodirect(_k);};this._o.selectId=-1;this._o.innerHTML="";;if(val.length==0){this.hidden();return;};var re=new RegExp(val,"i");;for(var i=0;i < this._item.length;i ++){;if(re.exec(this._itemValue[i])){this.appenItem(this._item[i],this._itemValue[i],val);hasItem=1;}};;if(!hasItem){this._o.style.visibility="hidden";return;};this.display();}};var Jmarquee=function(){return this.initialize.apply(this,arguments);};Jmarquee.prototype={initialize:function(args){var obj;var env=[];;if(!args||!(obj=($_(args.id)))){throw new Error("can't get marquee html tag");return;};this.obj=obj;this.env=args;this.obj.env=this.env;this.tmp_max=0;this.timedo=null;;if(args.content)this.setContents(args.content);obj.onmouseover=this.m_pause;obj.onmouseout=this.m_continue;},setContents:function(content){this.obj.innerHTML=content;},run:function(args){;if(args){;if(args.set_env){this.env=args;} else{Object.extend(this.env,args);}};this.env.stop=0;this.tmp_max=this.env.maxMove;;if(this.env.scrollDelay && this.env.scrollAmount){;if(this.timedo)clearTimeout(this.timedo);this.timedo=Args_setTimeout(this.worker,this.env.scrollDelay,this);}},worker:function(mq){var mq_stop=-1,s_value=0,xscroll=mq.env.scrollAmount;;if(mq.env.stop)return;;if(mq.env.pause){mq.timedo=Args_setTimeout(mq.worker,mq.env.scrollDelay,mq);return;};;if(mq.env.maxMove && mq.tmp_max < mq.env.scrollAmount)xscroll=mq.tmp_max;;if(mq.env.direction.toLowerCase()=='up'){mq_stop=0;s_value=mq.obj.scrollTop;mq.obj.scrollTop +=xscroll;;if(s_value==mq.obj.scrollTop)mq_stop=1;};;if(mq.env.direction.toLowerCase()=='down'){mq_stop=0;s_value=mq.obj.scrollTop;mq.obj.scrollTop-=xscroll;;if(s_value==mq.obj.scrollTop)mq_stop=1;};;if(mq.env.direction.toLowerCase()=='left'){mq_stop=0;s_value=mq.obj.scrollLeft;mq.obj.scrollLeft +=xscroll;;if(s_value==mq.obj.scrollLeft)mq_stop=1;};;if(mq.env.direction.toLowerCase()=='right'){mq_stop=0;s_value=mq.obj.scrollLeft;mq.obj.scrollLeft-=xscroll;;if(s_value==mq.obj.scrollLeft)mq_stop=1;};;if(mq.env.maxMove){mq.tmp_max-=xscroll;;if(mq.tmp_max <=0)mq_stop=1;};;if(mq_stop){;if(mq.env.onComplete)mq.env.onComplete({main:mq,tag:mq.obj,custom:mq.env.custom });return;};mq.timedo=Args_setTimeout(mq.worker,mq.env.scrollDelay,mq);},m_pause:function(){this.env.pause=1;},m_continue:function(){this.env.pause=0;},align:function(xalign){var i_width=0,i_hight=0,nodes=this.obj.childNodes.length;;if(!nodes)return;;for(var i=nodes-1;i >=0;i--){i_width=Math.max(parseInt(this.obj.childNodes[i].offsetWidth).NaN0(),i_width);i_hight +=parseInt(this.obj.childNodes[i].offsetWidth).NaN0();};xalign=xalign.toLowerCase();;if(xalign=='left'){this.obj.scrollLeft=0;} else if(xalign=='right'){this.obj.scrollLeft=i_width;} else if(xalign=='top'){this.obj.scrollTop=0;} else if(xalign=='bottom'){this.obj.scrollTop=i_hight;}},stop:function(){this.env.stop=1;;if(this.timedo)clearTimeout(this.timedo);return;},reset:function(){this.obj.scrollLeft=0;this.obj.scrollTop=0;}};var DRAG=JClass.create();DragRange=DRAG.prototype={drags:[],canvas:"",do_obj:"",extra_offX:0,extra_offY:0,Z_index:100,fix_element:[],all:[],exists:function(id){return this.drags[id];},add:function(id){;if(DragRange.exists(id)){throw new Error("Drag obj exist: [" +id+ "]");return false;};DragRange.drags[id]=id;return true;},initialize:function(tagName,id,x,y){var is_static=0;;if(document.getElementsByTagName('BODY').length==0)document.write('<body></body>');;if(!DragRange.canvas)DragRange.canvas=document[ 'CSS1Compat'==document.compatMode ? 'documentElement':'body'];this.canvas=DragRange.canvas;;if(!id)return false;;if($_(id)){var obj=$_(id);is_static=1;} else{var obj=document.body.appendChild(document.createElement(tagName));obj.setAttribute("id",id);};;if(is_static &&(!obj.style.left||!obj.style.top)){var s_top=0,s_left=0;do{s_top +=obj.offsetTop;s_left +=obj.offsetLeft;} while(obj=obj.offsetParent);;if(typeof(x)=='undefined')x=s_left;;if(typeof(y)=='undefined')y=s_top;};this.setTag(id,x,y);},setTag:function(id,x,y){;if(!id||!$_(id))return false;var obj=$_(id);this.tag=obj;DragRange.all[id]=this;obj.thisDrag=this.thisDrag;;if(!DragRange.add(id))return false;obj.canvas=DragRange.canvas;obj.style.position="absolute";obj.offLeft=0;obj.offTop=0;obj.dragEnabled=true;obj.boundEnabled=false;obj.sync_group=[];Object.extend(obj,this.onDragPrototype);this.moveTo(x,y);},thisDrag:function(){return DragRange.all[this.id];},setDrag:function(){this.tag.dragEnabled=true},disableDrag:function(){this.tag.dragEnabled=false},setinnerHTML:function(html){this.tag.innerHTML=html},setBounds:function(a,b,c,d){this.tag.minX=a,this.tag.minY=b,this.tag.maxX=c,this.tag.maxY=d;this.tag.boundEnabled=true;},scroll_fix:function(status){;if(status){;if(!DragRange.fix_element[this.id]){this.tag.fixLeft=this.tag.offsetLeft-this.tag.canvas.scrollLeft;this.tag.fixTop=this.tag.offsetTop-this.tag.canvas.scrollTop;DragRange.fix_element[this.id]=this;;if(!DragRange.fix_element.length)setTimeout('DragRange.fixDrag()',100);DragRange.fix_element.length ++;}} else{;if(DragRange.fix_element[this.id]){delete DragRange.fix_element[this.id];DragRange.fix_element.length--;}}},fixDrag:function(){var length=0;;if(!DragRange.fix_element.length)return;;for(var id in DragRange.fix_element){var obj=DragRange.fix_element[id];;if(!obj)continue;length ++;;if(obj.tag.draging)continue;obj.tag.style.top=obj.tag.canvas.scrollTop + obj.tag.fixTop;obj.tag.style.left=obj.tag.canvas.scrollLeft + obj.tag.fixLeft;};;if(length)setTimeout('DragRange.fixDrag()',100);},moveTo:function(x,y){var x1=parseInt(x),y1=parseInt(y);;if(!isNaN(x1))this.tag.style.left=x1+ "px";;if(!isNaN(y1))this.tag.style.top=y1+ "px";},resize:function(w,h){;if(w)this.tag.style.width=parseInt(w).NaN0()+ 'px';;if(h)this.tag.style.height=parseInt(h),NaN0()+ 'px';},get_offset:function(){return{left:this.tag.style.left,top:this.tag.style.top,width:this.tag.style.width,Height:this.tag.style.height}},set_offset:function(obj,ee){var a=obj.offX(ee);var b=obj.offY(ee);obj.diffX=a-obj.last_X;obj.diffY=b-obj.last_Y;obj.last_X=a;obj.last_Y=b;},toHtmlTag:function(){return this.tag },getId:function(){return this.tag.id},mouseup:function(ee){var obj=DragRange.do_obj;;if(!obj)return;;if(obj.draging){;if(obj.releaseCapture){obj.releaseCapture();}else if(window.releaseEvents){window.releaseEvents(Event.MOUSEMOVE|Event.MOUSEUP);};;if(DragRange.fix_element[obj.id]){obj.fixLeft=obj.offsetLeft-obj.canvas.scrollLeft;obj.fixTop=obj.offsetTop-obj.canvas.scrollTop;};obj.draging=false;;if(obj.afterDrag)obj.afterDrag(ee);};document.onmousemove=DragRange.onmousemove;document.onmouseup=DragRange.onmouseup;;if(obj.save_opacity){obj.style.filter=obj.save_opacity.filter;obj.style.opacity=obj.save_opacity.opacity;obj.style.MozOpacity=obj.save_opacity.MozOpacity;};DragRange.setDragMouse(false);DragRange.do_obj=null;},mousemove:function(ee){var obj=DragRange.do_obj;;if(browser.msie && event.button==0||!obj.draging){document.onmouseup(ee);return false;};;if(obj.draging){var n_left=obj.offX(ee)-obj.s_X + obj.s_left + DragRange.extra_offX;var n_top=obj.offY(ee)-obj.s_Y + obj.s_top + DragRange.extra_offY;;if(n_top < 0)n_top=0;;if(obj.boundEnabled){;if(n_left < obj.minX)n_left=obj.minX;;if(n_left > obj.maxX)n_left=obj.maxX;;if(n_top < obj.minY)n_top=obj.minY;;if(n_top > obj.maxY)n_top=obj.maxY;};obj.thisDrag().moveTo(n_left,n_top);};DragRange.set_offset(obj,ee);;if(obj.sync_group){;for(var i in obj.sync_group){;if(obj.sync_group[i].style){obj.sync_group[i].style.left=parseInt(obj.sync_group[i].style.left,10)+ obj.diffX + "px";obj.sync_group[i].style.top=parseInt(obj.sync_group[i].style.top,10)+ obj.diffY + "px";}}};;if(obj.onDrag)obj.onDrag(ee,obj.diffX,obj.diffY);return false;},movesync_add:function(id){;if(!$_(id))return false;this.tag.sync_group[id]=$_(id);},movesync_remove:function(id){delete this.tag.sync_group[id];},onDrag:function(fun){this.tag.onDrag=fun;},beforeDrag:function(fun){this.tag.beforeDrag=fun;},afterDrag:function(fun){this.tag.afterDrag=fun;},beforeMouseDown:function(fun){this.tag.beforeMouseDown=fun;},onDragPrototype:{offX:function(ee){var offx=(document.all)?(this.canvas.scrollLeft+ event.clientX):(document.getElementById)?ee.pageX:"";;if(offx < 0)offx=0;return offx;},offY:function(ee){return(document.all)?(this.canvas.scrollTop+event.clientY):(document.getElementById)?ee.pageY:"";},rec_start:function(ee){this.s_X=this.offX(ee);this.s_Y=this.offY(ee);this.s_top=parseInt(this.style.top);this.s_left=parseInt(this.style.left);this.last_X=this.s_X;this.last_Y=this.s_Y;},onselectstart:function(){return false;},onmousedown:function(ee){;if(!this.dragEnabled)return;DragRange.do_obj=this;DragRange.setIframeMousemove(window,0,0);;if(this.beforeMouseDown && !this.beforeMouseDown(ee))return false;this.draging=true;this.rec_start(ee);this.style.zIndex=DragRange.Z_index++;;if(this.setCapture){this.setCapture();}else if(window.captureEvents){window.captureEvents(Event.MOUSEMOVE|Event.MOUSEUP);};DragRange.extra_offX=DragRange.extra_offY=0;DragRange.onmousemove=document.onmousemove;DragRange.onmouseup=document.onmouseup;document.onmousemove=DragRange.mousemove;document.onmouseup=DragRange.mouseup;;if(this.beforeDrag)this.beforeDrag(ee);;if(!this.save_opacity)this.save_opacity={filter:this.style.filter,opacity:this.style.opacity,MozOpacity:this.style.MozOpacity};this.style.filter +="alpha(opacity=75)";this.style.opacity=0.75;this.style.MozOpacity=0.75;return false;}},setIframeMousemove:function(win,offx,offy){;if(browser.msie)return;var iframes=win.document.getElementsByTagName("IFRAME");;for(var i=0;i < iframes.length;i++){var ifr=iframes[i];try{var Doc=ifr.contentWindow.document;var offinfo=getOffset(ifr);Doc.mainFrame=ifr;} catch(err){continue;};Doc.captureEvents(Event.MOUSEMOVE|Event.MOUSEUP);Doc.canvas=Doc[ 'CSS1Compat'==document.compatMode ? 'documentElement':'body'];;if(!Doc._setDragMouse){Doc._DragMousemove=Doc.onmousemove;Doc._DragMouseup=Doc.onmouseup;Doc._setDragMouse=true;};DragRange.setDragMouse(Doc);Doc.onmousemove=function(ee){var docOffinfo=getOffset(this.mainFrame);Doc._offx=offx + docOffinfo.left;Doc._offy=offy + docOffinfo.top;DragRange.extra_offX=Doc._offx;DragRange.extra_offY=Doc._offy;DragRange.mousemove(ee);DragRange.extra_offX=0;DragRange.extra_offY=0;};Doc.onmouseup=function(ee){;if(DragRange.do_obj && DragRange.do_obj.draging){document.onmouseup(ee);} else{DragRange.setDragMouse(false);}};;if(Doc.getElementsByTagName("IFRAME").length)DragRange.setIframeMousemove(ifr.contentWindow,offx + offinfo.left,offy + offinfo.top);}},_DragMouseAll:new Array(),setDragMouse:function(DocObj){var saveDragMouse=DragRange._DragMouseAll;;if(DocObj){saveDragMouse[saveDragMouse.length]=DocObj;} else{;if(!saveDragMouse.length)return;;for(var i=saveDragMouse.length-1;i >=0;i--){;if(saveDragMouse[i]._setDragMouse){saveDragMouse[i].onmousemove=saveDragMouse[i]._DragMousemove;saveDragMouse[i].onmouseup=saveDragMouse[i]._DragMouseup;saveDragMouse[i].releaseEvents(Event.MOUSEMOVE|Event.MOUSEUP);saveDragMouse.splice(i,1);}}}}};function getOffset(obj){var left=0,top=0;var Owidht=obj.offsetWidth;var Oheight=obj.offsetHeight;;while(obj.offsetParent){left +=obj.offsetLeft +(obj.currentStyle?(parseInt(obj.currentStyle.borderLeftWidth).NaN0()):0);top  +=obj.offsetTop  +(obj.currentStyle ?(parseInt(obj.currentStyle.borderTopWidth).NaN0()):0);obj=obj.offsetParent;};left +=obj.offsetLeft +(obj.currentStyle?(parseInt(obj.currentStyle.borderLeftWidth).NaN0()):0);top  +=obj.offsetTop  +(obj.currentStyle?(parseInt(obj.currentStyle.borderTopWidth).NaN0()):0);left=parseInt(left).NaN0();top=parseInt(top).NaN0();Owidht=parseInt(Owidht).NaN0();Oheight=parseInt(Oheight).NaN0();return{'left':left,'top':top,'width':Owidht,'height':Oheight};};function DRAG_STATIC(id){var obj=$_(id);var left=0,top=0;;while(obj.offsetParent){left +=obj.offsetLeft +(obj.currentStyle?(parseInt(obj.currentStyle.borderLeftWidth).NaN0()):0);top  +=obj.offsetTop  +(obj.currentStyle ?(parseInt(obj.currentStyle.borderTopWidth).NaN0()):0);obj=obj.offsetParent;};left +=obj.offsetLeft +(obj.currentStyle?(parseInt(obj.currentStyle.borderLeftWidth).NaN0()):0);top  +=obj.offsetTop  +(obj.currentStyle?(parseInt(obj.currentStyle.borderTopWidth).NaN0()):0);this.setTag(id,left,top);};DRAG_STATIC.prototype=new DRAG();DRAG_STATIC.prototype.constructor=DRAG_STATIC;function JsWindow(args){var id=(args && args.id)?args.id:this.getId("");this.resizeable=true;this._resizeable=true;this.dragable=true;this.min_width=150;this.min_height=25;this.backgroundColor="#FF7F00";this._title="";this._content="";this.SizeRange={min_width:0,min_height:0,max_width:0,max_height:0};this.DropOnClose=0;this.HttpIframe="";this.onClose="";;if(args && this.getId(id)){delete args;throw new Error("JsWindow obj exist: [" +id+ "]");return false;};;if(typeof(args.resizeable)!='undefined')this.resizeable=args.resizeable;;if(args && args.DropOnClose)this.DropOnClose=1;;if(args && args.backgroundColor)this.backgroundColor=args.backgroundColor;var obj=document.body.appendChild(document.createElement("DIV"));obj.setAttribute('id',id);this.setTag(obj.id,0,0);obj.thisWindow=this.thisDrag;;if(args.head_imgs){this.head_imgs=args.head_imgs;} else{this.head_imgs=new Array("http://img.pcstore.com.tw/web_img/st/up-l.gif","http://img.pcstore.com.tw/web_img/st/bn_small.gif","http://img.pcstore.com.tw/web_img/st/bn_big.gif","http://img.pcstore.com.tw/web_img/st/bn_close.gif","http://img.pcstore.com.tw/web_img/st/up-r.gif");};var WinMain=this.toHtmlTag();WinMain.innerHTML='<table width="100%" height="21" style="height:21px" border="0" cellpadding="0" cellspacing="0" ondblclick="JsWindow.prototype.resizeme(this)"> <tr>' +((this.head_imgs[0])?'<td width="5" align="left" valign="bottom"><img id="JW_'+id+'_0" src="'+this.head_imgs[0]+'" width="5" height="20"></td>':'<td width="0"></td>')+'<td valign="middle" align="center" style="font-family: Verdana, Arial, Helvetica, sans-serif;font-size: 16px;color: #FFFFFF;background-color:'+this.backgroundColor+'">' +((browser.msie && browser.msie < 6)?'<iframe src="about:blank" scrolling="no" frameborder="0" style="z-index:-1;position:absolute; top:0px; left:5px;width:95%;height:100%;"> </iframe>':'')+'<span>&nbsp;</span></td> <td width="60" align="right" valign="middle" style="color: #FFFFFF;background-color:'+this.backgroundColor+';">' +((this.head_imgs[1])?'<img id="JW_'+id+'_1" src="'+this.head_imgs[1]+'" Height="15" hspace="3" border="0" align="absmiddle" style="cursor:pointer" onclick="JsWindow.prototype.jswin_resize(this,\'min\')">':'')+((this.head_imgs[2])?'<img id="JW_'+id+'_2" src="'+this.head_imgs[2]+'" Height="15" border="0" align="absmiddle" style="cursor:pointer" onclick="JsWindow.prototype.resizeme(this)">':'')+((this.head_imgs[3])?'<img id="JW_'+id+'_3" src="'+this.head_imgs[3]+'" Height="15" border="0" align="absmiddle" style="cursor:pointer" onclick="JSWin.getWinById(\''+id+'\').close();"></td>':'')+((this.head_imgs[4])?'<td width="5" align="right" valign="bottom"><img id="JW_'+id+'_4" src="'+this.head_imgs[4]+'" width="5" height="20"></td>':'')+'</tr> </table>';WinMain.innerHTML +='<div style="font-size:13px;line-height:18px;padding:0px;border:1px '+this.backgroundColor+' solid;background-color:#FFFFFF;">' +((browser.msie && browser.msie < 6)?'<iframe src="about:blank" scrolling="no" frameborder="0" style="z-index:-1;position:absolute;top:21px;left:0px;width:100%;"> </iframe>':'')+ '</div>';this.titleBar=WinMain.childNodes[0];this.bindHeadImg();this.winBody=WinMain.childNodes[1];this.winBody.style.borderRightWidth="2px";this.winBody.style.borderBottomWidth="2px";this.min_height=this.winBody.offsetHeight + parseInt(this.titleBar.style.height);;if(args && args.body)this.setBody(args.body);this.resize(parseInt(args.width),parseInt(args.Height));;if(args && args.action)this.action(args.action);;if(args && args.title)this.setTitle(args.title);this.beforeMouseDown(this.mousedown);this.afterDrag(this.DoafterDrag);obj.onmousemove=this.mousemove;};JsWindow.prototype=new DRAG();JsWindow.prototype.constructor=JsWindow;JsWindow.prototype.bindHeadImg=function(){var head_imgs=this.head_imgs;var tmpImg=new Image();var id=this.id;tmpImg.src=head_imgs[0];tmpImg.onload=function(){;for(var i=0;i < head_imgs.length;i ++){;if(this.src==head_imgs[i] && i < head_imgs.length){$_('JW_'+id+'_' + i).src=this.src;tmpImg.src=head_imgs[i + 1];}}}};JsWindow.prototype.mousemove=function(ee){this.thisWindow().titleBar.rows[0].cells[1].style.cursor=(this.thisWindow().dragable)?"move":"default";;if(!this.thisWindow().resizeable)return;var off_info=this.thisWindow().get_se_resize(this,ee);var offx=(document.all)?(this.canvas.scrollLeft+event.clientX):(document.getElementById)?ee.pageX:"";var offy=(document.all)?(this.canvas.scrollTop+event.clientY):(document.getElementById)?ee.pageY:"";var ox=(offx >=off_info[0] && offx <=off_info[1]);var oy=(offy >=off_info[2] && offy <=off_info[3]);;if(ox||oy){;if(ox && oy){this.style.cursor="se-resize";} else if(ox){this.style.cursor="e-resize";} else{this.style.cursor="s-resize";}} else{this.style.cursor="default";}};JsWindow.prototype.DoafterDrag=function(){this.thisWindow().setMinPosition('afterDrag');};JsWindow.prototype.mousedown=function(ee){;if((ee && ee.which !=1)||(!ee && event.button !=1))return false;var obj=this;var off_info=this.thisWindow().get_se_resize(this,ee);var offx=(document.all)?(this.canvas.scrollLeft+event.clientX):(document.getElementById)?ee.pageX:"";var offy=(document.all)?(this.canvas.scrollTop+event.clientY):(document.getElementById)?ee.pageY:"";var ox=(offx >=off_info[0] && offx <=off_info[1]);var oy=(offy >=off_info[2] && offy <=off_info[3]);;if(this.thisWindow().resizeable &&(ox||oy)){this.do_resize=1;this.save_x=offx;this.save_y=offy;this.save_mouseup=document.onmouseup;this.ox=ox;this.oy=oy;this.style.zIndex=DragRange.Z_index++;;if(this.setCapture){this.setCapture();}else if(window.captureEvents){window.captureEvents(Event.MOUSEMOVE|Event.MOUSEUP);};document.onmouseup=function(ee){JsWindow.prototype.setiframeMove();obj.do_resize=0;document.mouseup=obj.save_mouseup;;if(obj.releaseCapture){obj.releaseCapture();}else if(window.releaseEvents){window.releaseEvents(Event.MOUSEMOVE|Event.MOUSEUP);};document.onmousemove=obj.save_mousemove;};obj.save_mousemove=document.onmousemove;document.onmousemove=function(ee){;if(browser.msie && event.button==0){document.onmouseup(ee);return false;};var offx=(document.all)?(obj.canvas.scrollLeft+event.clientX):(document.getElementById)?ee.pageX:"";var offy=(document.all)?(obj.canvas.scrollTop+event.clientY):(document.getElementById)?ee.pageY:"";;if(obj.do_resize){;if(obj.ox)var n_w=offx-parseInt(obj.style.left);;if(obj.oy)var n_h=offy-parseInt(obj.style.top);obj.thisWindow().resize(n_w,n_h);};return true;};;if(window.captureEvents){var offinfo=getOffset(obj.thisWindow().winIframe);JsWindow.prototype.iframeMove(window,obj,0-offinfo.left,0-offinfo.top);};return false;} else{;if(!this.thisWindow().dragable)return false;;if(window.captureEvents && obj.thisWindow().winIframe){obj.thisWindow().winIframe.mouse_top=obj.offY(ee)-parseInt(obj.style.top);};return true;};obj.do_resize=0;return true;};with(JsWindow){prototype._iframeSetMove=new Array();prototype.getId=function(id){;if(!id){this.id=JSWin.getId();return this.id;};;if(JSWin.all[id])return true;this.id=id;JSWin.all[id]=this;return false;};prototype.thisWindow=function(){return JSWin.all[this.id];};prototype.display=function(){this.toHtmlTag().style.display="";};prototype.close=function(){;if(this.onClose && this.onClose(this.id)==-1)return;this.setMinPosition(false);this.toHtmlTag().style.display="none";;if(this.DropOnClose)DropObj(this.toHtmlTag());};prototype.jswin_resize=function(obj,type){var tmpObj,Jswin="";;for(tmpObj=obj;tmpObj;tmpObj=tmpObj.parentNode){;if(tmpObj.tagName=='DIV'){Jswin=tmpObj.thisWindow();break;}};;if(!Jswin)return false;var chktype="";;if(type=='min')chktype=(Jswin.winsize=="min")?"normal":"min";;if(Jswin.checkResize && Jswin.checkResize(Jswin.id,chktype)==-1)return;;if(type=='close'){var obj=Jswin.toHtmlTag();Jswin.setMinPosition(false);Jswin.toHtmlTag().style.visibility="hidden";;if(Jswin.DropOnClose)DropObj(Jswin.toHtmlTag());} else if(type=='min'){;if(Jswin.winBody.style.visibility !="hidden"){;if(Jswin.winsize !='max' && Jswin.winsize !='min')Jswin.norm_info=Jswin.get_offset();Jswin._resizeable=(Jswin.resizeable==false)?false:true;Jswin.resizeable=true;Jswin.winBody.style.visibility="hidden";Jswin.resize(Jswin.min_width,Jswin.min_height);Jswin.setMinPosition(true);Jswin.resizeable=false;Jswin.winsize='min';Jswin._saveTitle=Jswin._title;Jswin.setTitle(Jswin._title.substr(0,8));}else{Jswin.winsize='normal';Jswin.setMinPosition(false);Jswin.resizeable=true;Jswin.resize(parseInt(Jswin.norm_info.width),parseInt(Jswin.norm_info.Height));;if(Jswin._resizeable==false)Jswin.resizeable=false;Jswin.winBody.style.visibility="";Jswin.moveTo(Jswin.norm_info.left,Jswin.norm_info.top);Jswin.setTitle(Jswin._saveTitle);}}};prototype.action=function(action){var obj=this.winBody;var i=(browser.msie)?1:0;var src_height="";;if(this.HttpIframe)i++;;while(obj.childNodes.length > i)obj.removeChild(obj.lastChild);;if(!this.HttpIframe){action.parent=this.winBody;action.style="width:100%;height:100%;";this.HttpIframe=new HTTPIFM(action);this.winIframe=this.winBody.lastChild;(action.form)?this.HttpIframe.submit(action.form):this.HttpIframe.submit();}else{this.winIframe=this.winBody.lastChild;this.winBody.lastChild.style.display="";this.HttpIframe.setOpt(action);(action.form)?this.HttpIframe.submit(action.form):this.HttpIframe.submit();};;if(this.winIframe)this.winIframe.style.height=parseInt(this.toHtmlTag().style.height)-parseInt(this.titleBar.style.height);};prototype.getBody=function(){return this._content;};prototype.setBody=function(content){var obj=this.winBody;var i=(browser.msie)?1:0;var src_height="";this._content=content;;if(this.winBody.style.height)src_height=this.winBody.style.height;this.winBody.style.height="";;if(this.HttpIframe)i ++;;while(obj.childNodes.length > i){obj.removeChild(obj.lastChild);};;if(this.HttpIframe){this.winBody.lastChild.style.display="none";this.winIframe=this.winBody.lastChild;};this.winBody.innerHTML +=content;this.min_height=this.winBody.offsetHeight + parseInt(this.titleBar.style.height);;if(src_height)this.winBody.style.height=src_height;};prototype.resizeme=function(obj){var status=0;;while(obj.tagName !='TABLE' && obj.parentNode)obj=obj.parentNode;;if(!obj)return;var Jswin=obj.parentNode.thisWindow();;if(Jswin.resizeable==false)return;Jswin.setMinPosition(false);Jswin.resizeable=true;;if(Jswin._saveTitle)Jswin.setTitle(Jswin._saveTitle);;if(!Jswin.winsize||Jswin.winsize=='normal'||Jswin.winsize=='min'){;if(Jswin.winsize !='min')Jswin.norm_info=Jswin.get_offset();var canvas=Jswin.toHtmlTag().canvas;Jswin.winBody.style.visibility="";Jswin.moveTo(canvas.scrollLeft,canvas.scrollTop);Jswin.resize(canvas.clientWidth,canvas.clientHeight);Jswin.resize(canvas.clientWidth,canvas.clientHeight);Jswin.winsize='max';} else{Jswin.moveTo(Jswin.norm_info.left,Jswin.norm_info.top);Jswin.resize(parseInt(Jswin.norm_info.width),parseInt(Jswin.norm_info.Height));Jswin.winsize='normal';}};prototype.resize=function(w,h){;if(!this.resizeable)return;;if(w && this.SizeRange.min_width && w < this.SizeRange.min_width)w=this.SizeRange.min_width;;if(w && this.SizeRange.max_width && w > this.SizeRange.min_width)w=this.SizeRange.max_width;;if(h && this.SizeRange.min_height && h < this.SizeRange.min_height)h=this.SizeRange.min_height;;if(h && this.SizeRange.max_height && h > this.SizeRange.max_height)h=this.SizeRange.max_height;;if(w){w=Math.max(this.min_width,w);this.tag.style.width=w + 'px';};;if(h){h=Math.max(this.min_height,h);this.tag.style.height=h + 'px';this.winBody.style.height=(h-parseInt(this.titleBar.style.height))+ 'px';;if(this.HttpIframe)this.winIframe.style.height=(h-parseInt(this.titleBar.style.height))+ 'px';}};prototype.setTitle=function(title){;if(typeof(title)=='undefined')return;var obj=this.toHtmlTag();;if(!title)title="&nbsp;";;for(var i=0;i < obj.childNodes.length;i ++){;if(obj.childNodes[i].tagName=='TABLE'){var table=obj.childNodes[i];;if(table.rows[0] && table.rows[0].cells[1]){var column=table.rows[0].cells[1];;for(var i=0;i < column.childNodes.length;i ++){;if(column.childNodes[i].tagName=='SPAN'){column.childNodes[i].innerHTML=title;this._title=title;return;}}};return;}}};prototype.get_se_resize=function(obj,ee){var ret=new Array();ret[0]=parseInt(obj.style.left)+ parseInt(obj.style.width)-5;ret[1]=ret[0] + 10;ret[2]=parseInt(obj.style.top)+ parseInt(obj.style.height)-5;ret[3]=ret[2] + 10;return ret;};prototype.setMinPosition=function(type){var i=0,tmp=new Array();;if(type=='afterDrag' && !JSWin.min_status[this.id]){;if(this.winsize!='min')return;JSWin.min_status[this.id]=this;this.minId=JSWin.minId ++;};var canvas=this.toHtmlTag().canvas;;for(var id in JSWin.min_status){try{tmp[i++]=JSWin.min_status[id];}catch(err){}};;if(type){i=0;;if(type==true)this.minId=JSWin.minId ++;;for(var id in JSWin.min_status){try{(JSWin.min_status[id]);i++;} catch(err){}};var canvas=this.toHtmlTag().canvas;;if(type=='afterDrag'){var off_info=this.get_offset();i=0;;if((parseInt(off_info.top)>=(canvas.clientHeight + canvas.scrollTop-40))){tmp.sort(function(a,b){return(a.minId-b.minId)});this.scroll_fix(false);type=true;;for(var j=0;j < tmp.length;j ++)if(tmp[j]==this){i=j;break;}}};var n_left=(this.min_width + 1)* i;var n_top=canvas.clientHeight + canvas.scrollTop-20;;if(type==true){JSWin.min_status[this.id]=this;this.moveTo(n_left,n_top);this.scroll_fix(true);};;if(!i)setTimeout('JSWin.fix_minWind()',100);};;if(type !=true){delete JSWin.min_status[this.id];;if(type=='afterDrag'||(!type && this.winsize=='normal')){tmp.sort(function(a,b){return(a.minId-b.minId)});var n_top=canvas.clientHeight + canvas.scrollTop-20;;for(j=0;j < tmp.length;j ++)if(tmp[j]==this)break;;for(j+=1;j < tmp.length;j ++){var n_left=(this.min_width + 1)*(j-1);tmp[j].scroll_fix(false);tmp[j].moveTo(n_left,n_top);tmp[j].scroll_fix(true);}};this.scroll_fix(type);}};prototype.setiframeMove=function(DocObj){var saveMoveObj=prototype._iframeSetMove;;if(DocObj){saveMoveObj[saveMoveObj.length]=DocObj;} else{;if(!saveMoveObj.length)return;;for(var i=saveMoveObj.length-1;i >=0;i--){;if(saveMoveObj[i]._setSrcMove){saveMoveObj[i].onmousemove=saveMoveObj[i]._mousemove;saveMoveObj.splice(i,1);}}}};prototype.iframeMove=function(win,resizeObj,offx,offy){var iframes=win.document.getElementsByTagName("IFRAME");;for(var i=0;i < iframes.length;i++){var ifr=iframes[i];var offinfo=getOffset(ifr);var Doc=ifr.contentWindow.document;;if(!Doc._setSrcMove){Doc._mousemove=Doc.onmousemove;Doc._setSrcMove=true;};prototype.setiframeMove(Doc);Doc._offx=offx + offinfo.left;Doc._offy=offy + offinfo.top;Doc.onmousemove=function(ee){;if(resizeObj.do_resize){var n_w=(resizeObj.ox)?(ee.pageX + this._offx-1):"";var n_h=(resizeObj.oy)?(ee.pageY + this._offy + resizeObj.childNodes[0].offsetHeight-1):"";resizeObj.thisWindow().resize(n_w,n_h);}};Doc.onmouseup=function(ee){resizeObj.do_resize=0;prototype.setiframeMove(false);return false;};;if(Doc.getElementsByTagName("IFRAME").length)JsWindow.prototype.iframeMove(ifr.contentWindow,resizeObj,Doc._offx,Doc._offy);}}};JSWin={all:[],nameId:0,min_status:[],minId:0,getId:function(id){return "JSWIN_" + this.nameId ++;},fix_minWind:function(){var i=0;;for(var id in JSWin.min_status){try{JSWin.min_status[id];i ++;}catch(err){};var JSWIN=JSWin.min_status[id];var obj=JSWIN.toHtmlTag();;if(obj.draging)continue;canvas=obj.canvas;var off_info=JSWIN.get_offset();;if(parseInt(off_info.top)!=(canvas.clientHeight + canvas.scrollTop-20)&&parseInt(off_info.top)>(canvas.clientHeight + canvas.scrollTop-40)){JSWIN.scroll_fix(false);JSWIN.moveTo("",canvas.clientHeight + canvas.scrollTop-20);JSWIN.scroll_fix(true);}};;if(i)setTimeout('JSWin.fix_minWind()',100);},getWinById:function(id){return JSWin.all[id];}};
//-->
